# üë• –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è Google Calendar –∏ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## üìã –û–±–∑–æ—Ä –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- ‚úÖ **Google Calendar –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é** - —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—è—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∫–æ–º–∞–Ω–¥—ã
- ‚úÖ **Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—é
- ‚úÖ **–£–º–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥ —Ç–∏–ø–∞ "–ù–∞–ø–æ–º–Ω–∏—Ç—å –ò—Ä–µ –æ –≤—Å—Ç—Ä–µ—á–µ –∑–∞–≤—Ç—Ä–∞ –≤ 15:00"
- ‚úÖ **–ë–∞–∑—É –¥–∞–Ω–Ω—ã—Ö** - —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—á–∞—Å—Ç–Ω–∏–∫–∞—Ö –∫–æ–º–∞–Ω–¥—ã –∏ –∏—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ —Å—Ö–µ–º—É –≤ Supabase Dashboard
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ supabase-schema.sql –≤ SQL Editor
```

### 2. –ó–∞–ø—É—Å–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–∞–Ω–¥—ã

```bash
npm run setup:team
```

–°–∫—Ä–∏–ø—Ç —Å–æ–±–µ—Ä–µ—Ç:
- üë§ –ò–º–µ–Ω–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∫–æ–º–∞–Ω–¥—ã
- üè∑Ô∏è –ü—Å–µ–≤–¥–æ–Ω–∏–º—ã –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
- üì± Telegram Chat ID
- üìÖ Google Calendar Email –∏ ID

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google API

–°–æ–∑–¥–∞–π—Ç–µ `google-credentials.json` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```json
{
  "type": "service_account",
  "project_id": "your-project-id",
  "private_key_id": "key-id",
  "private_key": "-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n",
  "client_email": "ai-assistant@your-project.iam.gserviceaccount.com",
  "client_id": "client-id",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/ai-assistant%40your-project.iam.gserviceaccount.com"
}
```

## üì± –ü–æ–ª—É—á–µ–Ω–∏–µ Telegram Chat ID

### –ú–µ—Ç–æ–¥ 1: –ß–µ—Ä–µ–∑ –±–æ—Ç–∞ @userinfobot
1. –ù–∞–π–¥–∏—Ç–µ @userinfobot –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –ë–æ—Ç –≤–µ—Ä–Ω–µ—Ç –≤–∞—à Chat ID

### –ú–µ—Ç–æ–¥ 2: –ß–µ—Ä–µ–∑ @RawDataBot
1. –ù–∞–π–¥–∏—Ç–µ @RawDataBot
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –í –æ—Ç–≤–µ—Ç–µ –Ω–∞–π–¥–∏—Ç–µ `"id": 123456789`

### –ú–µ—Ç–æ–¥ 3: –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ telegram.org
// –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
window.Telegram.WebApp.initDataUnsafe.user.id
```

## üìÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Calendar

### 1. –°–æ–∑–¥–∞–Ω–∏–µ Service Account
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –í–∫–ª—é—á–∏—Ç–µ Google Calendar API
4. –°–æ–∑–¥–∞–π—Ç–µ Service Account
5. –°–∫–∞—á–∞–π—Ç–µ JSON –∫–ª—é—á

### 2. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—é
1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è —É—á–∞—Å—Ç–Ω–∏–∫–∞
2. –í —Ä–∞–∑–¥–µ–ª–µ "–î–æ—Å—Ç—É–ø –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –ª—é–¥–µ–π"
3. –î–æ–±–∞–≤—å—Ç–µ email –∏–∑ `client_email` –≤ JSON –∫–ª—é—á–µ
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∞ "–í–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–æ–±—ã—Ç–∏—è"

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ Calendar ID
- **–û—Å–Ω–æ–≤–Ω–æ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å**: `primary`
- **–î—Ä—É–≥–æ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å**: –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∫–∞–ª–µ–Ω–¥–∞—Ä—è –Ω–∞–π–¥–∏—Ç–µ "Calendar ID"

## üîß –î–µ—Ç–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```sql
-- –£—á–∞—Å—Ç–Ω–∏–∫–∏ –∫–æ–º–∞–Ω–¥—ã
CREATE TABLE team_members (
    id UUID PRIMARY KEY,
    tenant_id UUID,
    display_name TEXT NOT NULL,
    aliases TEXT[], -- –ø—Å–µ–≤–¥–æ–Ω–∏–º—ã
    tg_chat_id TEXT, -- Telegram Chat ID
    gcal_connection_id UUID, -- —Å–≤—è–∑—å —Å Google Calendar
    meta JSONB -- –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
);

-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –≤–Ω–µ—à–Ω–∏–º —Å–µ—Ä–≤–∏—Å–∞–º
CREATE TABLE connections (
    id UUID PRIMARY KEY,
    tenant_id UUID,
    provider TEXT, -- 'google'
    secret_ref TEXT, -- —Å—Å—ã–ª–∫–∞ –Ω–∞ credentials
    scopes TEXT[], -- —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
    meta JSONB -- –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
);

-- –ú–∞—Ä—à—Ä—É—Ç—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
CREATE TABLE routes (
    id UUID PRIMARY KEY,
    tenant_id UUID,
    name TEXT,
    match JSONB, -- —É—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
    action JSONB -- –¥–µ–π—Å—Ç–≤–∏—è (–∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã)
);
```

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥

```bash
# –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –¥–ª—è –∫–æ–º–∞–Ω–¥—ã
"–ù–∞–ø–æ–º–Ω–∏—Ç—å –ò—Ä–µ –æ –≤—Å—Ç—Ä–µ—á–µ –∑–∞–≤—Ç—Ä–∞ –≤ 15:00"
"–ù–∞–ø–æ–º–Ω–∏—Ç—å –ú–∞—à–µ –∫—É–ø–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã –∑–∞–≤—Ç—Ä–∞"
"–ù–∞–ø–æ–º–Ω–∏—Ç—å –í–∞–Ω–µ –ø–æ–∑–≤–æ–Ω–∏—Ç—å –≤ –±–∞–Ω–∫ —Å–µ–≥–æ–¥–Ω—è –≤ 18:00"

# –ó–∞–¥–∞—á–∏ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã
"–ó–∞–¥–∞—á–∞ –¥–ª—è –ò—Ä—ã: —Å–¥–µ–ª–∞–π –±–æ—Ç–∞"
"–ü–æ–ø—Ä–æ—Å–∏ –í–∞–Ω—é –ø–æ–∑–≤–æ–Ω–∏—Ç—å –≤ –±–∞–Ω–∫"
"–ü–æ—Ä—É—á–∏ –ú–∞—à–µ –∫—É–ø–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã"
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É—á–∞—Å—Ç–Ω–∏–∫–∏ —Å–æ–∑–¥–∞–Ω—ã
npm run setup:team
```

### 2. –¢–µ—Å—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ù–∞–ø–æ–º–Ω–∏—Ç—å –ò—Ä–µ –æ –≤—Å—Ç—Ä–µ—á–µ –∑–∞–≤—Ç—Ä–∞ –≤ 15:00"
–ë–æ—Ç –¥–æ–ª–∂–µ–Ω: 
‚úÖ –ù–∞–π—Ç–∏ –ò—Ä—É –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
‚úÖ –°–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ –≤ Google Calendar
‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram
‚úÖ –ó–∞–ø–∏—Å–∞—Ç—å –≤ Google Sheets
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
```bash
npm run dev
# –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
```

## ‚ùå –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### "Google Calendar API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `google-credentials.json`
- ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Google Calendar API –≤–∫–ª—é—á–µ–Ω
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—é

### "–£—á–∞—Å—Ç–Ω–∏–∫ –∫–æ–º–∞–Ω–¥—ã –Ω–µ –Ω–∞–π–¥–µ–Ω"
- ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run setup:team`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∏–º–µ–Ω–∏
- ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Å–µ–≤–¥–æ–Ω–∏–º—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

### "Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è"
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `TELEGRAM_BOT_TOKEN`
- ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Chat ID –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞
```bash
npm run setup:team
# –í—ã–±–µ—Ä–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞"
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
```sql
-- –û–±–Ω–æ–≤–∏—Ç—å Google Calendar ID
UPDATE team_members 
SET meta = jsonb_set(meta, '{gcal_id}', '"new-calendar-id"')
WHERE display_name = '–ò–º—è —É—á–∞—Å—Ç–Ω–∏–∫–∞';

-- –û–±–Ω–æ–≤–∏—Ç—å Telegram Chat ID
UPDATE team_members 
SET tg_chat_id = 'new-chat-id'
WHERE display_name = '–ò–º—è —É—á–∞—Å—Ç–Ω–∏–∫–∞';
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã
```bash
# –ó–∞–ø—É—Å–∫ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –ª–æ–≥–∞–º–∏
DEBUG=* npm run dev
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
curl http://localhost:3000/api/health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
curl http://localhost:3000/api/records?tenant_id=YOUR_TENANT_ID
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–∞–Ω–¥—ã:
1. üß™ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
2. üìä –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Google Sheets –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
3. üîî –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
4. üöÄ –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ —Å –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ API –∫–ª—é—á–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –≤ Google Calendar
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

**–£—Å–ø–µ—à–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–∞–Ω–¥—ã! üéâ**
